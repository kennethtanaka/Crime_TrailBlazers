{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Dependencies\n",
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "inputHidden": false,
    "outputHidden": false
   },
   "outputs": [],
   "source": [
    "# Name of the CSV file\n",
    "file15 = 'Resources/2015_Portland_Crime_Data.csv'\n",
    "file16 = 'Resources/2016_Portland_Crime_Data.csv'\n",
    "file17 = 'Resources/2017_Portland_Crime_Data.csv'\n",
    "file18 = 'Resources/2018_Portland_Crime_Data.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "inputHidden": false,
    "outputHidden": false
   },
   "outputs": [],
   "source": [
    "# The correct encoding must be used to read the CSV in pandas\n",
    "df_2015 = pd.read_csv(file15, encoding=\"ISO-8859-1\")\n",
    "df_2016 = pd.read_csv(file16, encoding=\"ISO-8859-1\")\n",
    "df_2017 = pd.read_csv(file17, encoding=\"ISO-8859-1\")\n",
    "df_2018 = pd.read_csv(file18, encoding=\"ISO-8859-1\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Address</th>\n",
       "      <th>CaseNumber</th>\n",
       "      <th>CrimeAgainst</th>\n",
       "      <th>Neighborhood</th>\n",
       "      <th>OccurDate</th>\n",
       "      <th>OccurTime</th>\n",
       "      <th>OffenseCategory</th>\n",
       "      <th>OffenseType</th>\n",
       "      <th>OpenDataLat</th>\n",
       "      <th>OpenDataLon</th>\n",
       "      <th>OpenDataX</th>\n",
       "      <th>OpenDataY</th>\n",
       "      <th>ReportDate</th>\n",
       "      <th>OffenseCount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15-X197430</td>\n",
       "      <td>Person</td>\n",
       "      <td>Piedmont</td>\n",
       "      <td>5/12/2015</td>\n",
       "      <td>1400</td>\n",
       "      <td>Assault Offenses</td>\n",
       "      <td>Intimidation</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5/12/2015</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15-X4282999</td>\n",
       "      <td>Person</td>\n",
       "      <td>Buckman West</td>\n",
       "      <td>5/1/2015</td>\n",
       "      <td>2143</td>\n",
       "      <td>Assault Offenses</td>\n",
       "      <td>Simple Assault</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5/1/2015</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15-X4283033</td>\n",
       "      <td>Person</td>\n",
       "      <td>University Park</td>\n",
       "      <td>5/1/2015</td>\n",
       "      <td>1625</td>\n",
       "      <td>Assault Offenses</td>\n",
       "      <td>Simple Assault</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5/1/2015</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15-X4283218</td>\n",
       "      <td>Person</td>\n",
       "      <td>Madison South</td>\n",
       "      <td>5/1/2015</td>\n",
       "      <td>1820</td>\n",
       "      <td>Assault Offenses</td>\n",
       "      <td>Simple Assault</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5/1/2015</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15-X4283218</td>\n",
       "      <td>Person</td>\n",
       "      <td>Madison South</td>\n",
       "      <td>5/1/2015</td>\n",
       "      <td>1820</td>\n",
       "      <td>Kidnapping/Abduction</td>\n",
       "      <td>Kidnapping/Abduction</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5/1/2015</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Address   CaseNumber CrimeAgainst     Neighborhood  OccurDate  OccurTime  \\\n",
       "0     NaN   15-X197430       Person         Piedmont  5/12/2015       1400   \n",
       "1     NaN  15-X4282999       Person     Buckman West   5/1/2015       2143   \n",
       "2     NaN  15-X4283033       Person  University Park   5/1/2015       1625   \n",
       "3     NaN  15-X4283218       Person    Madison South   5/1/2015       1820   \n",
       "4     NaN  15-X4283218       Person    Madison South   5/1/2015       1820   \n",
       "\n",
       "        OffenseCategory           OffenseType  OpenDataLat  OpenDataLon  \\\n",
       "0      Assault Offenses          Intimidation          NaN          NaN   \n",
       "1      Assault Offenses        Simple Assault          NaN          NaN   \n",
       "2      Assault Offenses        Simple Assault          NaN          NaN   \n",
       "3      Assault Offenses        Simple Assault          NaN          NaN   \n",
       "4  Kidnapping/Abduction  Kidnapping/Abduction          NaN          NaN   \n",
       "\n",
       "   OpenDataX  OpenDataY ReportDate  OffenseCount  \n",
       "0        NaN        NaN  5/12/2015             1  \n",
       "1        NaN        NaN   5/1/2015             1  \n",
       "2        NaN        NaN   5/1/2015             1  \n",
       "3        NaN        NaN   5/1/2015             1  \n",
       "4        NaN        NaN   5/1/2015             1  "
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_2015.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "# convert the 'OccurDate' column to datetime format \n",
    "df_2015['Date']= pd.to_datetime(df_2015['OccurDate']) \n",
    "  \n",
    "# Check the format of 'Date' column \n",
    "#df_2015.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "37374"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#filter out dates that are not year 2015\n",
    "df_2015 = df_2015[(df_2015['Date'].dt.year == 2015)]\n",
    "len(df_2015)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "56015"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# convert the 'OccurDate' column to datetime format \n",
    "df_2016['Date']= pd.to_datetime(df_2016['OccurDate']) \n",
    "\n",
    "#filter out dates that are not year 2016\n",
    "df_2016 = df_2016[(df_2016['Date'].dt.year == 2016)]\n",
    "len(df_2016)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "58634"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# convert the 'OccurDate' column to datetime format \n",
    "df_2017['Date']= pd.to_datetime(df_2017['OccurDate']) \n",
    "\n",
    "#filter out dates that are not year 2016\n",
    "df_2017 = df_2017[(df_2017['Date'].dt.year == 2017)]\n",
    "len(df_2017)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "59215"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# convert the 'OccurDate' column to datetime format \n",
    "df_2018['Date']= pd.to_datetime(df_2018['OccurDate']) \n",
    "\n",
    "#filter out dates that are not year 2016\n",
    "df_2018 = df_2018[(df_2018['Date'].dt.year == 2018)]\n",
    "len(df_2018)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Merge 2015 and 2016 dataframes using an outer join \n",
    "#outer will get everything\n",
    "dfmerge1 = pd.merge(df_2015, df_2016, on=\"OccurDate\", how=\"outer\")\n",
    "dfmerge1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Merge 2015, 2016 with 2017 dataframes using an outer join \n",
    "#outer will get everything\n",
    "dfmerge2 = pd.merge(dfmerge1, df_2017, on=\"OccurDate\", how=\"outer\")\n",
    "dfmerge2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Merge 2015, 2016, 2017 with 2018 dataframes using an outer join \n",
    "#outer will get everything\n",
    "totaldf = pd.merge(dfmerge2, df_2018, on=\"OccurDate\", how=\"outer\")\n",
    "totaldf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "totaldf.heah"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "inputHidden": false,
    "outputHidden": false
   },
   "outputs": [],
   "source": [
    "# Delete extraneous columndel df_2015['Address']\n",
    "del df_2015['CaseNumber']\n",
    "del df_2015['CrimeAgainst']\n",
    "del df_2015['OpenDataLat']\n",
    "del df_2015['OpenDataLon']\n",
    "del df_2015['OpenDataX']\n",
    "del df_2015['OpenDataY']\n",
    "del df_2015['ReportDate']\n",
    "del df_2015['OffenseCount']\n",
    "df_2015.head()\n",
    "# or create new dataframe without extraneous column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "inputHidden": false,
    "outputHidden": false
   },
   "outputs": [],
   "source": [
    "# Identify incomplete rows\n",
    "df_2015.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_2015.dtypes\n",
    "#object is base level variable"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_2015.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#sort by date in ascending order\n",
    "df_2015sort = df_filter.sort_values('Date')\n",
    "df_2015sort"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_2015sort.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "inputHidden": false,
    "outputHidden": false
   },
   "outputs": [],
   "source": [
    "# Drop all rows with any column with missing information\n",
    "df_2015clean = df_2015sort.dropna(how='any')\n",
    "#can also drop based on particular column\n",
    "#reference https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dropna.html"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "inputHidden": false,
    "outputHidden": false
   },
   "outputs": [],
   "source": [
    "# Verify dropped rows\n",
    "df_2015clean.count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Display an overview of the OffenseCategory column\n",
    "df_2015clean['OffenseCategory'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Display an overview of the OffenseType column\n",
    "df_2015clean['OffenseType'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Display an overview of the Neighborhood column\n",
    "df_2015clean['Neighborhood'].value_counts()"
   ]
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "kernel_info": {
   "name": "python3"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  },
  "nteract": {
   "version": "0.2.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
